<div class="modal fade" id="exampleModal031" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">

  <div class="modal-dialog" role="document">
    <div class="modal-content modal-responsive" >
      <div class="modal-body" style="display: block;">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="position: absolute;right: -42px;top: -39px;">
          <span aria-hidden="true">Close</span>
        </button>

        <h2 class="modelheader" style="text-align:center;">Meet a Physician</h2>
        <p class="message"></p>

        <%= render 'shared/request_appointment_form' %>

        <p class="disclaimer">Please do not submit any sensitive medical information. If you are in need of medical
          attention, please see a physician or call 911 in case of a medical emergency.</p>
      </div>
    </div>
  </div>
</div>
<main class="content" id="content">
<div class="section dark-header">
  <div class="content-contain">
    <% if @doctor.image.attached?%>
     <%= image_tag(url_for(@doctor.image), alt: "#{@doctor.name}") %>
    <%else%>
      <%= image_tag("#{@doctor.avatar}", alt: "#{@doctor.name}") %>
    <%end%>
    <div class="sub-section">
      <h1 class="smallest alt-color"><%=@doctor.name%>,<%=@doctor.physician_types.map{|p| p.name}.join(',')%></h1>
      <p class="center-city"><%=@doctor.doctor_categories.map{|cat| cat.name}.join()%></p>
      <div class="buttons">

        <button class="styled-link request-appointment" data-toggle="modal" data-target="#exampleModal031">Meet a Physician
      </button>
      </div>
    </div>
  </div>
</div>
<div class="section">
  <div class="content-contain">
    <div class="half second-bg">
      <h3>Languages</h3>
      <% @doctor.language.split(',').each do |l|%>
      <p><%=l%></p>
      <%end%>
    </div>
    <% @doctor.centers.each do |center|%>
    <div class="physician-center">
      <h3><%=center.name%></h3>
      <p><%=center.address_city%>, <%=center.state_zip_code%></p>
      <br>
      <br>

      <a href="#" style="text-align: center;text-decoration: none;"><%=center.primary_phone%></a>
      <a href="/centers/<%=@doctor.centers.first.name%>" class="styled-link" style="text-decoration: none;">Details </a>

    </div>
    <%end%>
  </div>
</div>
<div class="shadow"></div>
</main>

<script type="text/javascript">
    var body = document.body;
    body.classList.remove("physicians");
    body.classList.add("physician");
</script>
<script type="text/javascript">
    
$('a').css('text-decoration', 'none');
  $(document).ready(function(){
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(showPosition);
    } else {
      alert("Geolocation is not supported by this browser.");
    }
    function showPosition(position) {
      if (<%= session[:lat].blank?%> && <%= session[:long].blank?%> ) {
        $.ajax({
          type: "GET",
          url: "/set_location",
          data: {lat: position.coords.latitude, long: position.coords.longitude},
          success: function (data) {},
          error: function (e) {}
        });
      }
    }
  });

    $(document).ready(function(){
      jQuery.noConflict();
      $(".modal_date").datepicker({dateFormat:"D M dd, yy"});
    });

    function searchWithCurrentLocation(source){
      if (navigator.geolocation) {
        if(source === 'location') {
          navigator.geolocation.getCurrentPosition(searchCenterWithLocation);
        } else {
          navigator.geolocation.getCurrentPosition(searchPhysicianWithLocation);
        }
      } else {
        alert("Geolocation is not supported by this browser.");
      }
    }

    function searchCenterWithLocation(position) {
      var url = "<%= root_url %>" + 'our_locations/search?lat=' + position.coords.latitude + '&long=' + position.coords.longitude;
      window.location.replace(url);
    }

    function searchPhysicianWithLocation(position) {
      var url = "<%= root_url %>" + 'physicians/search?lat=' + position.coords.latitude + '&long=' + position.coords.longitude;
      window.location.replace(url);
    }
  </script>
